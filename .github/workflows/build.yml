name: Build

on:
  push:
    branches: '*'
  pull_request:
    branches: '*'
  workflow_call:

jobs:
  bun-build:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ…±ï¸heckout
        uses: actions/checkout@v4

      - name: Set up ğŸ…±ï¸un
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest
      
      - name: Install
        run: bun install --frozen-lockfile

      - name: ğŸ…±ï¸uild
        run: bun run build

      - name: ğŸ…±ï¸opy ğŸ…±ï¸onfigs 
        run: |
          cp config.sample.json out/linux-x64/config.json
          cp config.sample.json out/windows-x64/config.json
      
      - name: ğŸ…±ï¸ompress ğŸ…±ï¸uilds
        run: |
          mkdir -p dist
          tar -C out/linux-x64 -czvf dist/linux-x64.tar.gz .
          zip -r -j dist/windows-x64.zip out/windows-x64/*
      
      - name: ğŸ…±ï¸pload ğŸ…±ï¸rtifacts
        uses: actions/upload-artifact@v4
        with:
          name: build
          path: dist

